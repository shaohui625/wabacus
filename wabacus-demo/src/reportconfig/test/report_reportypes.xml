<?xml version="1.0" encoding="UTF-8"?>
<applications xmlns="http://www.wabacus.com"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.wabacus.com ../xsd/wabacus.applications.xsd">
	<local-resources>
    	<resources>
     	   	<resource key ="pOptions" type=" com.wabacus.config.resource.OptionRes"> 
 		    <options>
	 					<option value="优秀" label="优秀" />
						<option value="良好" label="良好" />
						<option value="较好" label="较好" />
						<option value="很差" label="很差" />
		    </options>
	     </resource>
	 </resources>
</local-resources>
	<page id="editforlistpageTest1" js="/webresources/script/validate.js">
	<!-- 
 <interceptor>
	  		  <imports>
	  	 		   <import>com.wabacus.util.*</import>	
	  	 	  </imports>
	  	 	  <preaction>
	  	 		//rrequest.authorize("report1",null,null,"display","false");//将report1报表设置为不显示
	  	 		//rrequest.authorize("report2",null,null,"readonly","true");//将report2报表设置为只读
	  	 		//rrequest.authorize("report3",null,null,"disabled","true");//将report3报表设置为禁用
	  	 		rrequest.authorize("report1",null,null,"readonly","true");
	  	 	</preaction>
	  	 </interceptor>
	  	  -->
		<report id="report1" title="request{dept_name}详细资料" type="editabledetail">
			<display valuetdwidth="100px" labeltdwidth="71px"
				labelbgcolor="#f0f0f0" labelalign="right" valuealign="left">
				<col column="guid" property="_id" displaytype="hidden" />
				<col column="deptno" label="部门编号" valuestyleproperty="style='mso-number-format:\@'">
					<inputbox jsvalidate="isNotEmpty({0}列不允许为空)" />
				</col>
				<col column="deptname" label="部门名" br="true" />
				<col column="manager" label="部门经理" />
				<col column="builtdate" label="创建日期" datatype="date{yyyy-MM-dd}"
					br="true">
					<inputbox type="datepicker" jsvalidate="isDate({0}格式不对，必须为yyyy-MM-dd格式)" />
				</col>
				<col column="performance" label="表现" valuestyleproperty="colspan='3'"
					br="true">
					<inputbox type="selectbox">
						<option source="${pOptions}"/>
						<option value="" label="无" />
					</inputbox>
				</col>
				<col column="description" label="简介" datatype="clob"
					valuestyleproperty="colspan='3'">
					<inputbox type="textareabox" styleproperty="rows='5'" />
				</col>
			</display>
			<sql datasource="ds_mongo">
				<select>
					<value>
					<![CDATA[
						@code{tabname ="friends";}
						var queryMap = this.getQueryConditionMap();
						assertNotEmpty(queryMap,"请输入ID");
						findAsList(queryMap,tabname);
					]]>
				</value>
					<condition name="txtdeptno"  hidden="true">
						<value>
						<![CDATA[
							 ["_id":data]
						]]>
						</value>
					</condition>
				</select>
				<insert>
					insert(attrs(["deptno","deptname","manager","builtdate","performance","description"]))
				</insert>
				<update>
					update(attrs(["_id"]),attrs(["guid","deptno","deptname","manager","builtdate","performance","description"]))
				</update>
			</sql>
			<format>
				<value>
					rrequest.getRequest().setAttribute("dept_name",deptname);//存放request，以便显示标题时能取到
				</value>
			</format>
		</report>
	</page>
</applications>